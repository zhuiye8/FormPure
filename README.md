# Excel去重工具

这是一个使用PyQt5开发的Excel文件去重工具，可以帮助用户快速对Excel文件进行去重操作。

## 功能特点

- 加载Excel文件并预览数据
- 自由选择作为去重依据的列
- 支持多种去重模式（保留第一个、保留最后一个、全部删除）
- 预览去重结果
- 将去重后的数据保存为新的Excel文件
- 多线程处理，避免界面卡顿

## 项目结构

```
deduplication/
│
├── core/                  # 核心功能模块
│   ├── __init__.py
│   └── deduplication.py   # 去重核心功能实现
│
├── ui/                    # 用户界面模块
│   ├── __init__.py
│   └── styles.py          # UI样式定义
│
├── resources/             # 资源文件目录
│
├── __init__.py            # 项目初始化
├── main.py # 主程序入口
└── README.md              # 项目说明文档
```

## 安装依赖

在使用此工具之前，请确保已安装以下依赖库：

```bash
conda activate test  # 如果使用conda环境
pip install pandas PyQt5 openpyxl
```

## 使用方法

1. 运行程序：
   ```bash
   python excel_deduplication.py
   ```

2. 点击"选择文件"按钮选择要处理的Excel文件
3. 在列表中选择作为去重依据的一个或多个列
4. 从下拉菜单中选择保留重复项的方式：
   - `first (保留首次出现)`: 保留第一次出现的重复行
   - `last (保留最后出现)`: 保留最后一次出现的重复行
   - `False (全部删除)`: 删除所有重复行
5. 点击"执行去重"按钮
6. 查看去重结果后，点击"保存结果"按钮将结果保存为新的Excel文件

## 开发说明

### 扩展功能

要添加新功能，可以按照以下步骤操作：

1. 在`core`目录下创建相应的功能模块
2. 在主程序中引入新模块并集成功能
3. 在UI中添加对应的控件和交互逻辑

### 样式修改

如需修改界面样式，编辑`ui/styles.py`文件中的`STYLE_SHEET`变量。

## 注意事项

- 程序会在内存中处理Excel文件，对于非常大的文件可能会占用较多内存
- 表格预览仅显示前100行数据，以保证界面响应速度
- 去重操作基于pandas库的`drop_duplicates`函数实现
- 首次运行程序时会自动创建项目所需的目录结构 