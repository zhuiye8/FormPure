# Excel去重工具开发任务清单

## 待完成功能

### 1. 开源模型本地部署及配置 [最高优先级]
- [x] 添加模型下载管理功能
  - [x] 支持从Hugging Face等平台拉取开源中文预训练模型
  - [x] 提供模型下载进度显示和管理界面
  - [x] 实现模型版本管理和更新检测
- [x] 开发模型配置界面
  - [x] 添加模型选择下拉列表，显示已下载和可用的模型
  - [x] 提供模型参数配置选项（如阈值、批处理大小等）
  - [x] 支持启用/禁用模型功能的开关
- [x] 实现模型推理接口
  - [x] 开发通用模型加载和推理包装器
  - [x] 支持CPU和GPU（如有）推理模式切换
  - [x] 提供模型内存优化选项（量化、剪枝等）
- [x] 添加本地模型与简单算法的混合策略
  - [x] 实现先使用简单算法（编辑距离）筛选，再用模型精确比对的流程
  - [x] 支持用户自定义混合策略规则
  - [x] 提供性能和准确度平衡的配置选项
- [x] **集成模型功能到主界面**
  - [x] 将模型管理器界面添加到主应用
  - [x] 配置模型功能选项卡
  - [x] 实现模型功能与现有去重功能的整合

### 2. 整合单文件处理与批处理功能
- [x] 移除单文件处理标签页，仅保留批处理功能
- [x] 使批处理功能同时支持单文件和多文件处理
- [ ] 优化文件加载逻辑，支持所有文件统一操作

### 3. 增强列选择功能
- [x] 自动列出所有文件的所有工作表
- [x] 展示每个工作表的所有列供用户选择
- [x] 实现树形结构的列选择界面(文件>工作表>列)
- [ ] 支持按文件或工作表进行批量列选择

### 4. 修复选择框样式问题
- [x] 移除导致内容被覆盖的选择框样式设置
- [x] 优化选择框位置和显示方式
- [x] 确保所有选中项内容清晰可见

### 5. 中文数据相似度处理方法（调研结果）
- [x] 实现基于词向量（Word Embedding）的相似度计算
  - [x] 使用预训练的中文BERT/Word2Vec模型提取文本特征
  - [x] 计算文本间的余弦相似度，设置阈值判定相似性
- [x] 添加基于编辑距离的模糊匹配算法
  - [x] 实现Levenshtein距离计算
  - [x] 支持设置相似度阈值（如70%以上视为相似）
- [x] 集成文本标准化预处理
  - [x] 中文分词（使用jieba库）
  - [x] 去除标点符号、空格和停用词
  - [x] 繁简转换统一处理
- [x] 添加语义相似度模型
  - [x] 集成中文BERT/RoBERTa等预训练模型
  - [x] 提供高级语义相似度计算选项
- [ ] 优化处理性能
  - [ ] 实现批量处理的并行计算
  - [ ] 仅在需要时加载深度学习模型

### 6. 新增中文相似度比较功能
- [x] 添加相似度判断设置界面
  - [x] 提供算法选择（编辑距离/词向量/深度学习模型）
  - [x] 允许用户设置相似度阈值
  - [x] 支持对特定列启用相似度检测
- [ ] 实现相似数据预览功能
  - [ ] 展示相似数据组，突出显示相似部分
  - [ ] 提供相似度评分和推荐合并选项
- [ ] 添加智能合并功能
  - [ ] 自动选择信息最完整的记录
  - [ ] 支持手动选择保留哪些字段

## 已完成功能

### 1. 批处理功能
- [x] 添加批量选择多个Excel文件的功能
- [x] 实现批量处理文件的线程管理
- [x] 为批处理添加进度显示
- [x] 添加批处理结果汇总报告

### 2. 选择框样式优化
- [x] 修复选中框覆盖内容的问题
- [x] 调整表格中复选框的样式和位置
- [x] 优化选中状态的视觉反馈

### 3. 中文数据相似度处理方法
- [x] 实现基础文本相似度计算模块
  - [x] 实现Levenshtein距离计算和相似度转换
  - [x] 添加中文分词和基于分词的相似度计算
  - [x] 支持相似度阈值判断
  - [x] 提供文本预处理功能

### 4. 开源模型管理模块
- [x] 实现模型下载管理功能
  - [x] 支持从Hugging Face获取预训练模型
  - [x] 提供下载进度显示和管理
  - [x] 实现模型元数据管理
- [x] 开发模型配置界面
  - [x] 添加模型选择下拉列表
  - [x] 提供模型参数配置选项
  - [x] 支持启用/禁用模型功能
- [x] 实现模型推理接口
  - [x] 开发模型加载和推理包装器
  - [x] 支持CPU/GPU推理模式切换
  - [x] 提供模型量化优化选项
- [x] 实现混合策略基础功能
  - [x] 支持先使用简单算法筛选再用模型精确比对
  - [x] 提供多种混合策略选择
- [x] 提供高级语义相似度计算功能
  - [x] 集成中文BERT/RoBERTa等预训练模型
  - [x] 支持精确的语义级文本相似度比较
- [x] 集成到主界面
  - [x] 添加模型管理选项卡
  - [x] 添加模型设置选项卡
  - [x] 在去重功能中添加使用模型的选项

## 开发进度
- 开始日期: 2025-04-11
- 当前阶段: 性能优化和相似数据预览功能开发
- 上次更新: 2025-05-26
- 进度状态: 模型功能已集成到主界面，相似度比较功能已实现，性能优化和数据预览功能待开发

## 功能说明

### 1. 批处理功能
- 支持选择多个Excel文件进行批量去重处理
- 提供直观的进度显示和文件处理状态
- 可以随时停止批处理过程
- 汇总展示处理结果和统计信息
- 支持指定输出目录并保存处理后的文件

### 2. 选择框样式优化
- 修复了复选框覆盖内容的问题
- 优化了复选框的视觉效果和布局
- 提供了更明确的选中状态视觉反馈

### 3. 中文数据相似度处理方法
#### 技术方案比较

| 方法 | 优点 | 缺点 | 适用场景 |
|------|------|------|----------|
| 编辑距离（Levenshtein） | 简单直观，实现容易，速度快 | 不理解语义，只看字符差异 | 短文本、错别字检测 |
| 词袋模型(TF-IDF) | 计算快速，无需训练 | 不考虑词序和语义 | 关键词匹配、简单文档分类 |
| Word2Vec/FastText | 考虑词的语义信息，训练简单 | 上下文理解有限，固定向量长度 | 中等语义复杂度文本 |
| BERT/RoBERTa | 理解深层语义和上下文，精度高 | 计算资源消耗大，速度慢 | 复杂语义理解、需高精度场景 |
| 混合方法 | 可平衡性能和精度 | 实现复杂，需要调参 | 多样化数据集 |

#### 已实现方法
- **Levenshtein距离计算**：计算两个字符串之间的编辑距离，支持中文
- **基于分词的相似度计算**：使用jieba分词，计算词集合的Jaccard相似系数
- **相似度判断**：基于阈值判断两个文本是否相似，支持不同相似度算法 
- **模型相似度计算**：使用预训练的中文BERT模型计算文本的语义相似度

### 4. 开源模型本地部署
- [x] 实现模型下载管理功能
  - [x] 支持从Hugging Face获取预训练模型
  - [x] 提供下载进度显示和管理
  - [x] 实现模型元数据管理
- [x] 开发模型配置界面
  - [x] 添加模型选择下拉列表
  - [x] 提供模型参数配置选项
  - [x] 支持启用/禁用模型功能
- [x] 实现模型推理接口
  - [x] 开发模型加载和推理包装器
  - [x] 支持CPU/GPU推理模式切换
  - [x] 提供模型量化优化选项
- [x] 实现混合策略基础功能
  - [x] 支持先使用简单算法筛选再用模型精确比对
  - [x] 提供多种混合策略选择
- [x] 提供高级语义相似度计算功能
  - [x] 集成中文BERT/RoBERTa等预训练模型
  - [x] 支持精确的语义级文本相似度比较 